<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form with LocalStorage</title>

    <!-- Include Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* Style the popup container */
        
        .popup-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        /* Style the close button */
        
        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
        }
        /* Style the form */
        
        .popup-form label {
            display: block;
            margin-bottom: 10px;
        }
        
        .popup-form input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
        }
        
        .popup-form button {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        /* Style the table */
        
        table {
            margin-top: 20px;
            border-collapse: collapse;
            width: 100%;
        }
        
        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        th {
            background-color: #f2f2f2;
        }
        /* Style the delete button */
        
        button.deleteButton {
            background-color: #ff3333;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <!-- Trigger button to show the popup -->
    <button onclick="showPopup()">Open Form</button>

    <!-- Popup container -->
    <div class="popup-container" id="popupContainer">
        <span class="close-button" onclick="closePopup()">&times;</span>
        <form class="popup-form" id="myForm">
            <label for="website">Website:</label>
            <input type="text" id="website" name="website" required>

            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>

            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>

            <button type="button" onclick="submitForm()">Submit</button>
        </form>
    </div>

    <table border="1" id="dataTable">
        <thead>
            <tr>
                <th>Website</th>
                <th>Email</th>
                <th>Password</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="dataTableBody"></tbody>
    </table>

    <script>
        // Function to show the popup
        function showPopup() {
            var popupContainer = document.getElementById("popupContainer");
            popupContainer.style.display = "block";
        }

        // Function to close the popup
        function closePopup() {
            var popupContainer = document.getElementById("popupContainer");
            popupContainer.style.display = "none";
        }

        // Function to submit the form
        function submitForm() {
            // Get form values
            var website = document.getElementById("website").value;
            var email = document.getElementById("email").value;
            var password = document.getElementById("password").value;

            // Create an array to store form data
            var formDataArray = JSON.parse(localStorage.getItem("formData")) || [];

            // Create an object for the current form submission
            var currentFormData = {
                website: website,
                email: email,
                password: password
            };

            // Add the current form data to the array
            formDataArray.push(currentFormData);

            // Convert the array to a JSON string and store it in localStorage
            localStorage.setItem("formData", JSON.stringify(formDataArray));

            // Update the table with all form data
            updateTable();

            // Optionally, you can display a success message to the user
            alert("Form data submitted successfully!");

            // Close the popup after submission
            closePopup();
        }

        // Function to update the table with stored form data
        function updateTable() {
            var tableBody = document.getElementById("dataTableBody");

            // Clear existing table rows
            tableBody.innerHTML = "";

            // Retrieve stored form data from localStorage
            var formDataArray = JSON.parse(localStorage.getItem("formData")) || [];

            // Loop through the form data array and append rows to the table
            formDataArray.forEach(function(formData, index) {
                // Create a new row in the table and append it
                var newRow = tableBody.insertRow();
                var websiteCell = newRow.insertCell(0);
                var emailCell = newRow.insertCell(1);
                var passwordCell = newRow.insertCell(2);
                var actionCell = newRow.insertCell(3);

                // Populate the cells with form data
                websiteCell.innerHTML = formData.website;
                emailCell.innerHTML = formData.email;

                // Create hidden and visible inputs for the password
                var hiddenPasswordInput = document.createElement("input");
                hiddenPasswordInput.type = "password";
                hiddenPasswordInput.value = formData.password;
                passwordCell.appendChild(hiddenPasswordInput);

                var visiblePasswordInput = document.createElement("input");
                visiblePasswordInput.type = "text";
                visiblePasswordInput.value = formData.password;
                visiblePasswordInput.style.display = "none"; // Initially hidden

                // Create an eye icon button to toggle password visibility
                var toggleButton = document.createElement("button");
                toggleButton.innerHTML = "<i class='far fa-eye'></i>";
                toggleButton.onclick = function() {
                    togglePasswordVisibility(hiddenPasswordInput, visiblePasswordInput, toggleButton);
                };

                // Append the password elements and toggle button to the password cell
                passwordCell.appendChild(hiddenPasswordInput);
                passwordCell.appendChild(visiblePasswordInput);
                passwordCell.appendChild(toggleButton);

                // Add a "Delete" button with an onclick event to remove the corresponding entry
                var deleteButton = document.createElement("button");
                deleteButton.innerHTML = "Delete";
                deleteButton.className = "deleteButton"; // Apply the deleteButton class
                deleteButton.onclick = function() {
                    deleteEntry(index);
                };
                actionCell.appendChild(deleteButton);
            });
        }

        // Function to delete an entry from localStorage and update the table
        function deleteEntry(index) {
            var formDataArray = JSON.parse(localStorage.getItem("formData")) || [];

            // Remove the entry at the specified index
            formDataArray.splice(index, 1);

            // Update localStorage with the modified array
            localStorage.setItem("formData", JSON.stringify(formDataArray));

            // Update the table
            updateTable();
        }

        // Function to toggle password visibility
        function togglePasswordVisibility(hiddenInput, visibleInput, toggleButton) {
            if (hiddenInput.style.display === "none") {
                hiddenInput.style.display = "inline-block";
                visibleInput.style.display = "none";
                toggleButton.innerHTML = "<i class='far fa-eye'></i>";
            } else {
                hiddenInput.style.display = "none";
                visibleInput.style.display = "inline-block";
                toggleButton.innerHTML = "<i class='far fa-eye-slash'></i>";
            }
        }

        // Initialize the table on page load
        updateTable();
    </script>

</body>

</html>